<div class="container home-container" [@childrenAppear]="home_exists">
    <mat-card>
        <div class="header-area">
            <p class="title home-title">
                Hi, {{ user_name }}
            </p>
            <p class="create-button">
                <button mat-raised-button color="primary" (click)="add_category()">Add Category</button><button mat-raised-button color="primary" routerLink="/editor/new-article">Create Article</button>
            </p>
        </div>
        <div class="divider"></div>
        <div class="content-container">
            <div class="category-list">
                <mat-accordion *ngIf="categories.length; else emptyInfo" displayMode="flat">
                    <mat-expansion-panel *ngFor="let category of categories; let i = index" class="category-item" [@currentCategory]="current_category_id === category.category_id" [expanded]="current_category_id === category.category_id" (click)="set_step(category)">
                        <!-- [expanded]="current_category.category_id === category.category_id" -->
                        <mat-expansion-panel-header collapsedHeight="60px" expandedHeight="60px">
                            <mat-panel-title>
                                {{ category.category_name }}
                            </mat-panel-title>
                        </mat-expansion-panel-header>
                        <mat-action-row>
                            <!-- <button mat-raised-button color="primary" (click)="set_step(category)">Select</button> -->
                            <button mat-raised-button color="primary" [matMenuTriggerFor]="options">Options</button>
                            <mat-menu #options="matMenu">
                                <button mat-menu-item (click)="modify_category($event, category)">Modify</button>
                                <button mat-menu-item (click)="delete_category(category.category_id)" *ngIf="category.category_type">Delete</button>
                            </mat-menu>
                        </mat-action-row>
                    </mat-expansion-panel>
                </mat-accordion>
                <ng-template #emptyInfo>
                    <p style="width: 100%; text-align: center;">Add a Category~<br/><br/><button mat-raised-button color="primary" (click)="add_category()">Add Category</button></p>
                </ng-template>
            </div>

            <div class="spacer"></div>

            <div class="article-list">
                <mat-table #table [dataSource]="dataSource">

                    <ng-container cdkColumnDef="title" aria-colspan="2">
                        <mat-header-cell *cdkHeaderCellDef> Article </mat-header-cell>
                        <mat-cell *cdkCellDef="let row" class="title-ceil"><a mat-button routerLink="/article/{{row.article_id}}" color="primary">{{row.title ? row.title : 'Untitled'}}</a></mat-cell>
                    </ng-container>

                    <ng-container cdkColumnDef="author">
                        <mat-header-cell *cdkHeaderCellDef> Author </mat-header-cell>
                        <mat-cell *cdkCellDef="let row"> {{ row.user_name }} </mat-cell>
                    </ng-container>

                    <ng-container cdkColumnDef="category">
                        <mat-header-cell *cdkHeaderCellDef> Category </mat-header-cell>
                        <mat-cell *cdkCellDef="let row"> {{ row.category_name }} </mat-cell>
                    </ng-container>

                    <ng-container cdkColumnDef="create_time">
                        <mat-header-cell *cdkHeaderCellDef> Create Time </mat-header-cell>
                        <mat-cell *cdkCellDef="let row"> {{ row.create_time * 1000 | date: 'y-MM-dd HH:mm:ss' }} </mat-cell>
                    </ng-container>
                    <mat-header-row *cdkHeaderRowDef="displayedColumns"></mat-header-row>
                    <mat-row *cdkRowDef="let row; columns: displayedColumns;"></mat-row>
                </mat-table>
            </div>
        </div>
    </mat-card>
</div>